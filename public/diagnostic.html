<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LUMIERA - åå°è¯Šæ–­å·¥å…·</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f0;
    }
    .container {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 { color: #333; border-bottom: 3px solid #e74c3c; padding-bottom: 10px; }
    h2 { color: #666; margin-top: 30px; }
    .test-item {
      margin: 15px 0;
      padding: 15px;
      border-left: 4px solid #3498db;
      background: #f8f9fa;
    }
    .success { border-left-color: #2ecc71; background: #d4edda; }
    .error { border-left-color: #e74c3c; background: #fde8e8; }
    .warning { border-left-color: #f39c12; background: #fef3c7; }
    .btn {
      background: #3498db;
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      margin: 10px 5px;
    }
    .btn:hover { background: #2980b9; }
    .btn.secondary { background: #95a5a6; }
    .result { margin-top: 10px; font-weight: bold; }
    pre { background: #f4f4f4; padding: 10px; overflow-x: auto; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ” LUMIERA åå°è¯Šæ–­å·¥å…·</h1>

    <div class="test-item">
      <h3>1. æ£€æµ‹å½“å‰é¡µé¢ URL</h3>
      <p>å½“å‰è®¿é—®çš„åœ°å€ï¼š<strong id="currentUrl"></strong></p>
      <div class="result" id="urlCheck"></div>
    </div>

    <div class="test-item">
      <h3>2. æµ‹è¯•åç«¯è¿æ¥ (Port 9000)</h3>
      <button class="btn" onclick="testBackend9000()">æµ‹è¯• 9000 ç«¯å£</button>
      <div class="result" id="backend9000"></div>
    </div>

    <div class="test-item">
      <h3>3. æµ‹è¯•åç«¯è¿æ¥ (Port 63591)</h3>
      <button class="btn secondary" onclick="testBackend63591()">æµ‹è¯• 63591 ç«¯å£</button>
      <div class="result" id="backend63591"></div>
    </div>

    <div class="test-item">
      <h3>4. æµ‹è¯•ç®¡ç†å‘˜ç™»å½•</h3>
      <button class="btn" onclick="testLogin()">æµ‹è¯•ç™»å½•</button>
      <div class="result" id="loginTest"></div>
    </div>

    <div class="test-item warning">
      <h3>âš ï¸ é‡è¦æç¤º</h3>
      <p><strong>æ­£ç¡®çš„åå°åœ°å€æ˜¯ï¼š</strong><br>
        <code style="font-size: 18px; background: #eee; padding: 10px;">http://localhost:9000/app</code>
      </p>
      <p><strong>å¦‚æœæ‚¨çœ‹åˆ° 63591 ç«¯å£ï¼Œå¯èƒ½çš„åŸå› ï¼š</strong></p>
      <ul>
        <li>æµè§ˆå™¨ç¼“å­˜äº†æ—§çš„ URL</li>
        <li>ä¹¦ç­¾æˆ–å†å²è®°å½•æŒ‡å‘é”™è¯¯çš„åœ°å€</li>
        <li>æŸä¸ªä»£ç†æˆ–VPNé‡å®šå‘äº†è¯·æ±‚</li>
        <li>æ‰‹åŠ¨è¾“å…¥äº†é”™è¯¯çš„ç«¯å£</li>
      </ul>
    </div>

    <div class="test-item success">
      <h3>âœ… è§£å†³æ–¹æ¡ˆ</h3>
      <ol>
        <li><strong>æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼š</strong><br>
          <ul>
            <li>Mac: <code>Cmd + Shift + Delete</code></li>
            <li>Windows: <code>Ctrl + Shift + Delete</code></li>
            <li>é€‰æ‹©"ç¼“å­˜çš„å›¾ç‰‡å’Œæ–‡ä»¶"</li>
          </ul>
        </li>
        <li><strong>æ‰‹åŠ¨è®¿é—®æ­£ç¡®åœ°å€ï¼š</strong><br>
          <a href="http://localhost:9000/app" target="_blank" style="color: #3498db; font-weight: bold;">
            ç‚¹å‡»è¿™é‡Œ â†’ http://localhost:9000/app
          </a>
        </li>
        <li><strong>ä½¿ç”¨æ— ç—•/éšç§æ¨¡å¼ï¼š</strong><br>
          æ‰“å¼€æ–°çš„æ— ç—•çª—å£è®¿é—®æ­£ç¡®åœ°å€
        </li>
      </ol>
    </div>

    <div class="test-item">
      <h3>ç®¡ç†å‘˜ç™»å½•ä¿¡æ¯</h3>
      <pre>
Email: admin@lumiera.com
Password: AdminPassword123
      </pre>
    </div>
  </div>

  <script>
    // æ˜¾ç¤ºå½“å‰ URL
    document.getElementById('currentUrl').textContent = window.location.href;

    const currentUrl = window.location.href;
    const urlCheckDiv = document.getElementById('urlCheck');

    if (currentUrl.includes('63591')) {
      urlCheckDiv.innerHTML = '<span class="error">âŒ é”™è¯¯ï¼æ‚¨æ­£åœ¨è®¿é—®ç«¯å£ 63591ï¼Œåº”è¯¥è®¿é—® 9000ï¼</span>';
      urlCheckDiv.className = 'error';
    } else if (currentUrl.includes('9000')) {
      urlCheckDiv.innerHTML = '<span class="success">âœ… æ­£ç¡®ï¼æ‚¨æ­£åœ¨è®¿é—®ç«¯å£ 9000</span>';
      urlCheckDiv.className = 'success';
    } else {
      urlCheckDiv.innerHTML = '<span class="warning">âš ï¸ å½“å‰ URL ä¸æ˜ç¡®</span>';
      urlCheckDiv.className = 'warning';
    }

    // æµ‹è¯• 9000 ç«¯å£
    function testBackend9000() {
      const resultDiv = document.getElementById('backend9000');
      resultDiv.innerHTML = '<p>æµ‹è¯•ä¸­...</p>';

      fetch('http://localhost:9000/app/login')
        .then(r => {
          if (r.ok) {
            resultDiv.innerHTML = '<span class="success">âœ… æˆåŠŸï¼ç«¯å£ 9000 å¯ä»¥è®¿é—®</span>';
          } else {
            resultDiv.innerHTML = '<span class="error">âŒ å¤±è´¥ï¼ç«¯å£ 9000 è¿”å› ' + r.status + '</span>';
          }
        })
        .catch(e => {
          resultDiv.innerHTML = '<span class="error">âŒ é”™è¯¯ï¼š' + e.message + '</span>';
        });
    }

    // æµ‹è¯• 63591 ç«¯å£
    function testBackend63591() {
      const resultDiv = document.getElementById('backend63591');
      resultDiv.innerHTML = '<p>æµ‹è¯•ä¸­...</p>';

      fetch('http://localhost:63591/app/login')
        .then(r => {
          if (r.ok) {
            resultDiv.innerHTML = '<span class="success">âœ… æ„å¤–ï¼ç«¯å£ 63591 ä¹Ÿå¯ä»¥è®¿é—®</span>';
          } else {
            resultDiv.innerHTML = '<span class="error">âŒ å¤±è´¥ï¼ç«¯å£ 63591 è¿”å› ' + r.status + '</span>';
          }
        })
        .catch(e => {
          resultDiv.innerHTML = '<span class="warning">âš ï¸ æ­£å¸¸ï¼ç«¯å£ 63591 ä¸å¯è®¿é—®ï¼ˆ' + e.message + 'ï¼‰</span>';
        });
    }

    // æµ‹è¯•ç™»å½•
    function testLogin() {
      const resultDiv = document.getElementById('loginTest');
      resultDiv.innerHTML = '<p>æµ‹è¯•ç™»å½•ä¸­...</p>';

      fetch('http://localhost:9000/auth/user/emailpass', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
          email: 'admin@lumiera.com',
          password: 'AdminPassword123'
        })
      })
      .then(r => r.json())
      .then(data => {
        if (data.token) {
          resultDiv.innerHTML = '<span class="success">âœ… ç™»å½•æˆåŠŸï¼Token å·²ç”Ÿæˆ</span>';
        } else {
          resultDiv.innerHTML = '<span class="error">âŒ ç™»å½•å¤±è´¥ï¼</span>';
        }
      })
      .catch(e => {
        resultDiv.innerHTML = '<span class="error">âŒ é”™è¯¯ï¼š' + e.message + '</span>';
      });
    }

    // è‡ªåŠ¨è¿è¡Œæµ‹è¯•
    setTimeout(testBackend9000, 500);
    setTimeout(testBackend63591, 1000);
  </script>
</body>
</html>
